# 文档站点功能说明

本文档站点集成了 DishUI 的 ArticleControl 和 ArticleContextMenu 组件，提供了丰富的阅读辅助功能。

## 功能列表

### 1. ArticleControl（文章目录控制器）

**位置**: 页面右侧的浮动面板

**功能**:
- ✅ **自动提取目录**: 自动提取文档中的所有标题（h1-h6）
- ✅ **快速导航**: 点击标题可快速跳转到对应位置
- ✅ **智能高亮**: 滚动时自动高亮当前阅读的章节
- ✅ **可拖动**: 可以拖动到任意位置
- ✅ **可收起**: 可以收起为小圆球节省空间

**操作按钮**:
1. **高亮选中** 🖍️
   - 选中文本后点击此按钮，文本会被黄色背景高亮
   - 可以多次高亮不同的文本
   
2. **清除高亮** ❌
   - 清除所有高亮标记

### 2. ArticleContextMenu（右键菜单）

**触发方式**: 在文档内容区域右键点击

**菜单项**:
1. **高亮选中** 🖍️
   - 与 ArticleControl 中的功能相同
   - 高亮当前选中的文本
   
2. **清除高亮** ❌
   - 清除所有高亮标记
   
3. **复制** 📋
   - 如果有选中文本，复制选中的文本
   - 如果没有选中文本，复制整篇文章
   
4. **统计信息** 📊
   - 显示字符数、单词数、行数统计
   - 如果有选中文本，统计选中部分
   - 如果没有选中文本，统计整篇文章

## 使用场景

### 场景 1: 学习重点内容
在阅读技术文档时，可以高亮重要的概念、API 名称或关键代码片段：
1. 选中要高亮的文本
2. 点击 ArticleControl 中的"高亮选中"按钮，或右键选择"高亮选中"
3. 文本会被黄色背景高亮显示

### 场景 2: 快速导航
使用 ArticleControl 快速浏览和跳转：
1. 查看右侧的目录面板
2. 点击任意标题快速跳转
3. 当前阅读位置会自动高亮

### 场景 3: 内容统计
查看文档或选中内容的统计信息：
1. 右键点击文档任意位置
2. 选择"统计信息"
3. 查看字符数、单词数、行数

## 技术实现

### 高亮功能
- 使用**覆盖层（Overlay）**方法实现
- 保存原始的 `Range` 对象而不是静态坐标
- 在每次渲染时动态调用 `range.getClientRects()` 获取当前位置
- 使用 `fixed` 定位的 div 覆盖在文本上方显示高亮效果
- 监听滚动和窗口大小变化事件，实时更新高亮位置
- **不修改 DOM 结构**，不会破坏 Markdown 渲染，不会导致换行问题

### 状态管理
- 使用全局 `HighlightManager` 管理高亮状态
- 支持订阅/发布模式，实时更新高亮显示
- 切换页面时自动清除高亮

### 滚动跟随
- 监听 `scroll` 和 `resize` 事件
- 每次事件触发时强制重新渲染高亮覆盖层
- `Range.getClientRects()` 会自动返回相对于当前视口的位置
- 高亮会完美跟随文档滚动

## 工具对比

| 功能 | ArticleControl | ContextMenu |
|------|---------------|-------------|
| 高亮选中 | ✅ | ✅ |
| 清除高亮 | ✅ | ✅ |
| 复制文本 | ❌ | ✅ |
| 统计信息 | ❌ | ✅ |
| 目录导航 | ✅ | ❌ |

## 注意事项

1. **高亮持久性**: 高亮只在当前页面生效，刷新或切换页面后会自动清除
2. **性能**: 高亮使用覆盖层方法，不会影响文档的原始内容和性能
3. **浏览器兼容性**: 支持所有现代浏览器（Chrome、Firefox、Safari、Edge）
4. **响应式**: ArticleControl 可以拖动到任意位置，适应不同屏幕尺寸

## 快捷键

目前暂无快捷键支持，所有操作通过鼠标点击完成。

---

享受更好的阅读体验！ 📚✨

